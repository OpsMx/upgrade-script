query QueryRunHistoryWithApplicationDeployment {
    queryRunHistory @cascade {
        id
        applicationDeployment {
            applicationEnvironment {
                namespace
                application {
                    team {
                        id
                    }
                    name
                }
                deploymentTarget {
                    name
                }
                environment {
                    purpose
                }
            }
            toolsUsed {
                sbom
            }
            id
        }
    }
}

mutation UpdateRunHistoryWAppDeploymentID(
    $runHistoryID: [ID!]
    $deploymentID: String!
) {
    updateRunHistory(
        input: { filter: { id: $runHistoryID }, set: { DeploymentID: $deploymentID } }
    ) {
        numUids
    }
}

mutation UpdateRunHistoryWSbomTool(
    $runHistoryID: [ID!]
    $sbomTool: String!
) {
    updateRunHistory(
        input: { filter: { id: $runHistoryID }, set: { SbomTool: $sbomTool } }
    ) {
        numUids
    }
}

mutation UpdateRunHistoryWNamespace(
    $runHistoryID: [ID!]
    $namespace: String!
) {
    updateRunHistory(
        input: { filter: { id: $runHistoryID }, set: { Namespace: $namespace } }
    ) {
        numUids
    }
}

mutation UpdateRunHistoryWAccount(
    $runHistoryID: [ID!]
    $account: String!
) {
    updateRunHistory(
        input: { filter: { id: $runHistoryID }, set: { Account: $account } }
    ) {
        numUids
    }
}

mutation UpdateRunHistoryWCluster(
    $runHistoryID: [ID!]
    $cluster: String!
) {
    updateRunHistory(
        input: { filter: { id: $runHistoryID }, set: { Cluster: $cluster } }
    ) {
        numUids
    }
}

mutation UpdateRunHistoryWApplication(
    $runHistoryID: [ID!]
    $application: String!
) {
    updateRunHistory(
        input: { filter: { id: $runHistoryID }, set: { Application: $application } }
    ) {
        numUids
    }
}

mutation UpdateRunHistoryWTeamID(
    $runHistoryID: [ID!]
    $teamID: String!
) {
    updateRunHistory(
        input: { filter: { id: $runHistoryID }, set: { TeamID: $teamID } }
    ) {
        numUids
    }
}

query QueryRunHistoryWithArtifactScanData {
    queryRunHistory @cascade {
        id
        artifactScan {
            tool
        }
    }
}

query QueryPolicyEnforcement {
    queryPolicyEnforcement @cascade {
        id
        policy(filter: { id: { in: ["422","423","436","437","438","441","442","443","444","445","446","448","450","452"] } }) {
            id
        }
    }
}

mutation DeletePolicyDefinition {
    deletePolicyDefinition(
        filter: {
            id: {
                in: [
                    "422"
                    "423"
                    "436"
                    "437"
                    "438"
                    "441"
                    "442"
                    "443"
                    "444"
                    "445"
                    "446"
                    "448"
                    "450"
                    "452"
                ]
            }
        }
    ) {
        numUids
    }
}

mutation DeletePolicyEnforcement($id: ID!) {
    deletePolicyEnforcement(filter: { id: [$id] }) {
        msg
        numUids
    }
}


mutation UpdateNonBlockedApplicationDeployment {
    updateApplicationDeployment(
        input: {
            set: { firewall: false, deploymentResult: "passed" }
            filter: { not: { deploymentStage: { eq: blocked } } }
        }
    ) {
        numUids
    }
}

mutation UpdateBlockedApplicationDeployment {
    updateApplicationDeployment(
        input: {
            set: { firewall: true, deploymentResult: "blocked" }
            filter: { deploymentStage: { eq: blocked } }
        }
    ) {
        numUids
    }
}

mutation SetKubescapeLatestFileTSNodeToDefault {
    updateDeploymentTarget(
        input: { set: { kubescapeLatestFileTS: "" }, filter: { has: name } }
    ) {
        numUids
    }
}

